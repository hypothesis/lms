[tool.pytest.ini_options]
addopts = "-q"
filterwarnings = [
    "error", # Fail the tests if there are any warnings.
    "ignore:^find_module\\(\\) is deprecated and slated for removal in Python 3.12; use find_spec\\(\\) instead$:DeprecationWarning:importlib",
    "ignore:^FileFinder.find_loader\\(\\) is deprecated and slated for removal in Python 3.12; use find_spec\\(\\) instead$:DeprecationWarning:importlib",
    "ignore:^pkg_resources is deprecated as an API:DeprecationWarning:pkg_resources",
    "ignore:^pkg_resources is deprecated as an API:DeprecationWarning:pyramid",
    "ignore:^Deprecated call to .pkg_resources\\.declare_namespace\\('.*'\\).\\.:DeprecationWarning:pkg_resources",
    "ignore:^'cgi' is deprecated and slated for removal in Python 3\\.13$:DeprecationWarning:webob",
]

[tool.coverage.run]
branch = true
parallel = true
source = ["lms", "tests/unit"]
omit = [
    "*/lms/__main__.py",
    "*/lms/scripts/init_db.py",
    "lms/pshell.py",
    "lms/migrations/*",
    "lms/extensions/feature_flags/views/test.py",
    "lms/views/feature_flags_test.py",
]

[tool.coverage.paths]
source = ["src", ".tox/*tests/lib/python*/site-packages"]

[tool.coverage.report]
show_missing = true
precision = 2
fail_under = 100.00
skip_covered = true

[tool.isort]
multi_line_output = 3
include_trailing_comma = true
force_grid_wrap = 0
use_parentheses = true
line_length = 88
default_section = "THIRDPARTY"
known_first_party = ["lms", "tests"]

[tool.ruff]
target-version = "py311"
line-length = 88

[tool.ruff.lint]
select = ["C", "E", "F", "I", "R", "W", "D"]

ignore = [
  # Missing docstrings.
  "D100","D101","D102","D103","D104","D105","D106","D107",

  # "No blank lines allowed after function docstring" conflicts with the
  # Black code formatter which insists on inserting blank lines after
  # function docstrings.
  "D202",

  # "1 blank line required before class docstring" conflicts with another
  # pydocstyle rule D211 "No blank lines allowed before class docstring".
  "D203",

  # "Multi-line docstring summary should start at the first line"
  # and "Multi-line docstring summary should start at the second line".
  # These two rules conflict with each other so you have to disable one of them.
  # How about we disable them both? PEP 257 says either approach is okay:
  #
  # > The summary line may be on the same line as the opening quotes or on
  # > the next line.
  # >
  # > https://peps.python.org/pep-0257/#multi-line-docstrings
  "D212",
  "D213",

  "E501", # line-too-long
  "F401", # unused-import
  "RET",  # flake8-return 
] 



[tool.hdev]
project_name = "lms"
project_type = "application"

[tool.mypy]
python_version = 3.11

disable_error_code = [
    "arg-type",
    "attr-defined",
    "import-untyped",
]

[[tool.mypy.overrides]]
module= [
  "tests.*",
  "lms.migrations.*"
]
ignore_errors = true
